# SocTalk SecOps Agent Configuration
# Copy this file to .env and fill in your values

# =============================================================================
# LLM Configuration
# =============================================================================

# Choose exactly one provider: `anthropic` or `openai`
SOCTALK_LLM_PROVIDER=anthropic

# Provider credentials (mutually exclusive: do not set both keys)
# - Anthropic
ANTHROPIC_API_KEY=your-anthropic-api-key-here
# Optional: Anthropic-compatible gateway/base URL
# ANTHROPIC_BASE_URL=

# - OpenAI-compatible
# OPENAI_API_KEY=your-openai-api-key-here
# Optional: OpenAI-compatible gateway/base URL (e.g., OpenRouter/LocalAI)
# OPENAI_BASE_URL=
# OPENAI_API_BASE=
# OPENAI_ORGANIZATION=

# Model selection
# Fast model: Used for supervisor routing and workers
SOCTALK_FAST_MODEL=claude-sonnet-4-20250514

# Reasoning model: Used for verdict decisions (can use opus for better reasoning)
SOCTALK_REASONING_MODEL=claude-sonnet-4-20250514

# LLM parameters
SOCTALK_LLM_TEMPERATURE=0.0
SOCTALK_LLM_MAX_TOKENS=4096

# =============================================================================
# MCP Server Paths
# =============================================================================

# Base path for MCP servers (relative to this project)
MCP_SERVERS_BASE_PATH=..

# Or specify individual paths
# WAZUH_MCP_SERVER_PATH=../mcp-server-wazuh/target/release/mcp-server-wazuh
# CORTEX_MCP_SERVER_PATH=../mcp-server-cortex/target/release/mcp-server-cortex
# THEHIVE_MCP_SERVER_PATH=../mcp-server-thehive/target/release/mcp-server-thehive

# =============================================================================
# Wazuh Configuration
# =============================================================================

# Enable integration (used by Settings UI + MCP binding)
WAZUH_ENABLED=false

# Wazuh API URL (preferred; falls back to WAZUH_API_HOST/WAZUH_API_PORT)
# Example: https://wazuh.example.com:55000
WAZUH_URL=

# Wazuh Manager API
WAZUH_API_HOST=localhost
WAZUH_API_PORT=55000
WAZUH_API_USERNAME=wazuh
# Alternative name (K8s-friendly)
# WAZUH_API_USER=wazuh
WAZUH_API_PASSWORD=wazuh

# Wazuh Indexer (Elasticsearch)
WAZUH_INDEXER_HOST=localhost
WAZUH_INDEXER_PORT=9200
WAZUH_INDEXER_USERNAME=admin
WAZUH_INDEXER_PASSWORD=admin

# SSL verification (set to true for production)
WAZUH_VERIFY_SSL=false

# =============================================================================
# Cortex Configuration
# =============================================================================

# Enable integration (used by Settings UI + MCP binding)
CORTEX_ENABLED=false

# Cortex API endpoint
CORTEX_ENDPOINT=http://localhost:9001/api
# Alternative name
# CORTEX_URL=http://localhost:9001/api

# Cortex API key (get from Cortex admin panel)
CORTEX_API_KEY=your-cortex-api-key
# Optional TLS verify toggle (used by Settings UI)
# CORTEX_VERIFY_SSL=true

# =============================================================================
# TheHive Configuration
# =============================================================================

# Enable integration (used by Settings UI + MCP binding)
THEHIVE_ENABLED=false

# TheHive API endpoint
THEHIVE_URL=http://localhost:9000/api

# TheHive API token (get from TheHive admin panel)
THEHIVE_API_TOKEN=your-thehive-api-token
# Alternative name
# THEHIVE_API_KEY=your-thehive-api-token

# Optional organisation (used by Settings UI)
# THEHIVE_ORGANISATION=default

# SSL verification
THEHIVE_VERIFY_SSL=false

# =============================================================================
# Agent Configuration
# =============================================================================

# Polling interval in seconds
SOCTALK_POLLING_INTERVAL=30

# Maximum alerts to retrieve per poll
SOCTALK_MAX_ALERTS_PER_POLL=100

# Time window for alert correlation (minutes)
SOCTALK_CORRELATION_WINDOW=15

# =============================================================================
# Decision Thresholds
# =============================================================================

# Auto-close threshold: Investigations with TP confidence below this are auto-closed
SOCTALK_AUTO_CLOSE_THRESHOLD=0.25

# Escalation threshold: Confidence above this triggers escalation path
SOCTALK_ESCALATION_THRESHOLD=0.50

# Wazuh alert level considered critical (0-15)
SOCTALK_CRITICAL_SEVERITY=12

# =============================================================================
# Logging
# =============================================================================

# Log level: DEBUG, INFO, WARNING, ERROR
SOCTALK_LOG_LEVEL=INFO

# Log format: json or text
SOCTALK_LOG_FORMAT=json

# Rust log level for MCP servers
RUST_LOG=info

# =============================================================================
# Database Configuration
# =============================================================================

# PostgreSQL connection URL for event store and read models
DATABASE_URL=postgresql+asyncpg://soctalk:soctalk@localhost:5432/soctalk

# =============================================================================
# Settings UI
# =============================================================================

# When true, disables PUT/Reset for /api/settings (recommended for production)
SETTINGS_READONLY=false

# =============================================================================
# Authentication (opt-in)
# =============================================================================

# AUTH_MODE=none (default) disables authentication.
# AUTH_MODE=static enables env-defined users + signed session cookie.
# AUTH_MODE=proxy trusts headers from a trusted reverse proxy.
AUTH_MODE=none

# Static auth users (comma-separated):
#   username:password_hash:roles
# - roles are pipe-separated (admin|analyst|viewer) and always include viewer.
# - password_hash supports:
#   - pbkdf2_sha256$<iterations>$<salt_b64>$<digest_b64>  (recommended)
#   - plain$<password>  (dev only)
AUTH_USERS=

# Session signing secret (required for stable sessions in production)
AUTH_SESSION_SECRET=
AUTH_SESSION_TTL_SECONDS=43200
AUTH_COOKIE_SECURE=false

# Proxy auth (only when AUTH_MODE=proxy)
AUTH_TRUSTED_PROXY_CIDRS=
# AUTH_PROXY_ADMIN_GROUPS=admin
# AUTH_PROXY_ANALYST_GROUPS=analyst

# =============================================================================
# MISP Configuration
# =============================================================================

# Enable integration (used by Settings UI + MCP binding)
MISP_ENABLED=false

# MISP API endpoint
MISP_URL=https://localhost

# MISP API key
MISP_API_KEY=your-misp-api-key

# SSL verification
MISP_VERIFY_SSL=false

# =============================================================================
# Slack Notifications
# =============================================================================

# Enable Slack webhook notifications (secrets are env-only)
SLACK_ENABLED=false
SLACK_WEBHOOK_URL=
# SLACK_CHANNEL=#security-alerts
# SLACK_NOTIFY_ON_ESCALATION=true
# SLACK_NOTIFY_ON_VERDICT=true
